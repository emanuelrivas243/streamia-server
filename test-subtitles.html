<!DOCTYPE html>
<html>
<head>
    <title>Prueba Subt√≠tulos Streamia</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 850px;
            margin: 40px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        h1 {
            text-align: center;
        }
        video {
            width: 100%;
            max-width: 800px;
            display: block;
            margin: 20px auto;
            border-radius: 8px;
        }
        .subtitle-controls {
            text-align: center;
            margin: 30px auto;
            max-width: 600px;
        }
        .subtitle-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .subtitle-btn:hover {
            background: #1976D2;
            transform: scale(1.05);
        }
        .subtitle-btn.active {
            background: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }
        .subtitle-btn.disabled {
            background: #666;
        }
        .info {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 8px;
        }
        .current-subtitle {
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>üé¨ Prueba Subt√≠tulos - John Wick 4</h1>
    
    <video id="videoPlayer" controls>
        <source src="https://res.cloudinary.com/dwmt0zy4j/video/upload/v1761492843/John_Wick_4_2023_ggihbb.mp4" type="video/mp4">
        
        <track id="trackES" label="Espa√±ol" kind="subtitles" srclang="es" 
               src="https://res.cloudinary.com/dwmt0zy4j/raw/upload/v1761494555/streamia/subtitles/John_Wick_4_2023_ggihbb_es.vtt">
        
        <track id="trackEN" label="English" kind="subtitles" srclang="en" 
               src="https://res.cloudinary.com/dwmt0zy4j/raw/upload/v1761495823/streamia/subtitles/John_Wick_4_2023_ggihbb_en.vtt">
    </video>

    <div class="subtitle-controls">
        <h3>üéØ Control de Subt√≠tulos</h3>
        <button class="subtitle-btn disabled active" onclick="setSubtitle('off')">‚ûñ Desactivado</button>
        <button class="subtitle-btn" onclick="setSubtitle('es')">üá™üá∏ Espa√±ol</button>
        <button class="subtitle-btn" onclick="setSubtitle('en')">üá∫üá∏ English</button>
    </div>

    <div class="info">
        <p>‚úÖ <strong>SOLUCI√ìN AL BUG DE CHROME:</strong> Usa los botones de arriba</p>
        <p>üîÑ Cambia libremente: <strong>Desactivado ‚ÜîÔ∏è Espa√±ol ‚ÜîÔ∏è English</strong> (ilimitado)</p>
        <p>‚ö†Ô∏è El men√∫ CC nativo puede tener problemas en Chrome - usa los botones personalizados</p>
        <div class="current-subtitle" id="subtitleStatus">Estado: ‚ûñ Desactivado</div>
    </div>

    <script>
        const video = document.getElementById('videoPlayer');
        const statusDiv = document.getElementById('subtitleStatus');
        const buttons = document.querySelectorAll('.subtitle-btn');
        
        // Funci√≥n para cambiar subt√≠tulos
        function setSubtitle(lang) {
            const tracks = video.textTracks;
            
            // Desactivar todos primero
            for (let i = 0; i < tracks.length; i++) {
                tracks[i].mode = 'disabled';
            }
            
            // Activar el seleccionado
            if (lang === 'es') {
                tracks[0].mode = 'showing';
                updateUI('üá™üá∏ Espa√±ol', 1);
            } else if (lang === 'en') {
                tracks[1].mode = 'showing';
                updateUI('üá∫üá∏ English', 2);
            } else {
                updateUI('‚ûñ Desactivado', 0);
            }
        }
        
        // Actualizar interfaz
        function updateUI(text, activeBtn) {
            statusDiv.textContent = 'Estado: ' + text;
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active');
                if (index === activeBtn) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Inicializar
        window.addEventListener('load', function() {
            const tracks = video.textTracks;
            for (let i = 0; i < tracks.length; i++) {
                tracks[i].mode = 'disabled';
            }
            updateUI('‚ûñ Desactivado', 0);
        });
        
        // Sincronizar si usuario usa el men√∫ CC nativo
        video.textTracks.addEventListener('change', function() {
            const tracks = video.textTracks;
            let activeIndex = -1;
            
            for (let i = 0; i < tracks.length; i++) {
                if (tracks[i].mode === 'showing') {
                    activeIndex = i;
                    break;
                }
            }
            
            if (activeIndex === 0) {
                updateUI('üá™üá∏ Espa√±ol', 1);
            } else if (activeIndex === 1) {
                updateUI('üá∫üá∏ English', 2);
            } else {
                updateUI('‚ûñ Desactivado', 0);
            }
        });
    </script>
</body>
</html>